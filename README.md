# SendMailBatch

该项目实现了批量发送邮件的功能，可以实现针对不同的发件箱，发送不同的内容。

该项目是为了方便财务的同事在月底的时候发送工资表所用。

## 项目特点
鉴于每个邮箱都有垃圾邮箱的验证机制，如果在同一时间，同一个IP发送了大量的邮件，会被邮箱服务器当成是垃圾邮箱处理，本项目采用了手动设置时间间隔和添加多个发件箱来解决同时大量发送邮件的瓶颈问题。

项目可以保存发送的人员名单和状态，方便复核，同时，对于没有发送成功的，可以再次发送，此操作会忽略已经送达的人，省去了人工复核的繁琐步骤。

项目对发件箱的密码进行了加密，避免保存在本地的密码被泄漏。

## 使用的技术手段
1. log4net 记录日志
2. NPOI 读取 Excel 信息
3. XmlDocument 读取XML文件
4. SmtpClient 发送邮件
5. 多线程：使用单独的线程读取人员工资信息，将读取的信息进行缓存；利用Timer计时器定时从缓存中获取发送数据，发送完所有文件数据后销毁。

## 使用说明
1. 打开程序，输入校验码，此处校验码是用于对输入的电子邮箱密码进行加密，如果输入错误，电子邮箱将解密错误，不能发送邮件。
2. 导入含有发送内容的 Excel，选择sheet标签，Excel 见附带的模板
3. 添加标题，不可为空
4. 输入邮件正文，可为空
5. 输入每封邮件的发送时间间隔
6. 添加发送的人员
7. 添加发件箱
8. 开始发送

## 后续
写这个是为了方便财务的小姐姐们发送工资条的时候不那么辛苦，所以，本着能够满足使用就可以了，因为在别人的基础上修改而来，代码不精练，仅供大家参考。如果有需要批量发送工资条的同志，可以下载 release 版本直接使用。

## 致谢
本项目在[https://gitee.com/wpfpro/SendMailDemo](https://gitee.com/wpfpro/SendMailDemo)的基础上修改